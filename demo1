import { useEffect, useState } from "react";
import { useLocation } from "react-router-dom";
import { usePortForwardingRulesInfo } from "../../../domain/port-forwarding-rules/hooks";
import { CreateEditPortForwardingRuleInfo } from "../../../domain/port-forwarding-rules/models";
import { ErrorIndicator } from "../../components/error-indicator/ErrorIndicator";
import { LoadingIndicator } from "../../components/loading-indicator/LoadingIndicator";

export const AddEditPortForwardingRules = () => {
  const location = useLocation();
  const index = location.state?.index ?? undefined;

  // Use the hook to get the data
  const { data, isError, isPending, isFetching } = usePortForwardingRulesInfo();

  // Handle errors and loading states
  if (isError) {
    return <ErrorIndicator />;
  }

  if (isPending || isFetching || data === undefined) {
    return <LoadingIndicator />;
  }

  // Extract the specific rule to edit if index is defined
  const ruleToEdit = index !== undefined ? data[index] : null;

  // Render the component based on whether we are adding or editing
  return (
    <div>
      {index !== undefined ? (
        <div>
          <h2>Edit Port Forwarding Rule</h2>
          <pre>{JSON.stringify(ruleToEdit, null, 2)}</pre>
          {/* Add your form for editing here */}
        </div>
      ) : (
        <div>
          <h2>Add New Port Forwarding Rule</h2>
          {/* Add your form for creating here */}
        </div>
      )}
    </div>
  );
};
